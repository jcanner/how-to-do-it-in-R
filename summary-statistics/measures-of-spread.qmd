---
title: "Measures of Spread"
format: 
  live-html:
    webr:
      packages: 
        - mosaic
        - palmerpenguins
      cell-options:
        warning: false
        completion: false
html-math-method:
  method: mathjax
  url: "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
execute: 
  warning: false
code-copy: true
code-overflow: wrap
toc: true
css: ../styles.css
---

{{< include ../_extensions/r-wasm/live/_knitr.qmd >}}



```{webr}
#| label: theme
#| include: false
#| edit: false
library(ggplot2)
theme_set(theme_light())
options(ggplot2.continuous.color = scale_color_viridis_c, 
        ggplot2.continuous.fill = scale_fill_viridis_c,
        ggplot2.discrete.color = scale_color_viridis_d,
        ggplot2.discrete.fill = scale_fill_viridis_d)
```


## Getting Started

First, be sure you have installed `mosaic`. Remember, you only need to install each package once on your machine.

Then, be sure to load the packages `mosaic`. Remember, you need to do this with each new Quarto/RMarkdown document or R Session.

```{webr}
#| label: setup
library(mosaic) #for summary stats
```


### Data for Examples <a class="btn btn-primary" data-bs-toggle="collapse" href="#data-for-examples" role="button" aria-expanded="false" aria-controls="data-for-examples">Show</a>{.unlisted}

::: {#data-for-examples .collapse .multi-collapse}

As a reminder (see [Overview of Summary Statistics](summary-stats-overview.qmd)), we will be using the `penguins` data from the `palmerpenguins` package:

```{r}
#| label: load-penguins
library(palmerpenguins)
```

Here is a snippet of the data:

```{r}
#| label: data-structure 
#| echo: false
library(dplyr) #for slice_sample function
library(gt) #for table formatting
slice_sample(penguins, n = 5) |> 
  gt::gt() |> 
  gt::tab_header(title = "Palmer Penguins")
```

:::


## Variance 

::: {.callout-note collapse="true"}
## Definition: VARIANCE
The average of the distances from each data point in the sample to the sample mean $\bar{x}$, squared

$$s^2=\frac{\sum_{i=1}^{n}\left(\ x_i-\bar{x}\right)^2}{n-1}$$

The variance is one of the most important metrics in statistics. It is the measure of spread around the mean.

:::


### Basic Code

For a single quantitative variable, `x`, here is the general structure for calculating a variance in R using the `var()` function from the `mosaic` package.

```{r}
#| label: one-var-structure-variance
#| eval: false
var(~x, data = mydata)
```

Run the code below to see an example using the **quantitative** variable `bill_length_mm` from the `penguins` data. Then replace `bill_length_mm` with another quantitative variable from the `penguins` data (e.g. `bill_depth_mm`)

```{webr}
#| label: var-one
var(~bill_length_mm, data = penguins)
```

::: {.callout-warning}
## Handling Missing Values
Notice the returned value of `NA`. The function needs to have another argument added that tells R to ignore missing values (`NA`) in order to calculate the mean, `na.rm = TRUE`. Add the argument to the code above

```{r}
#| label: one-var-structure-na-variance
#| eval: false
var(~x, data = mydata, na.rm = TRUE)
```

:::


When we want to calculate the variance of a **quantitative** variable (`y`) measured across the values/groups of a **categorical** variable (`x`) it is a simple modification to the single variance code.

```{r}
#| label: two-var-structure-variance
#| eval: false
var(y ~ x, data = mydata)
```

Run the code below to see an example using the **quantitative** variable `bill_length_mm` and `species` from the `penguins` data. Then replace `bill_length_mm` with another quantitative variable from the `penguins` data (e.g. `bill_depth_mm`) and/or another categorical variable (e.g., `sex`). 

Remember to add `na.rm = TRUE` if you get a *warning*. 

```{webr}
#| label: var-two
var(bill_length_mm ~ species, data = penguins)
```


## Standard Deviation

:::{.callout-note collapse="true"}

## Definition: STANDARD DEVIATION
The standard deviation is the square root of the variance. It also measures the spread about the mean, always zero or greater than zero, and is used more often than the variance as it has the same units of measurement as the original observations.

$$s= \sqrt{s^2} = \sqrt{\frac{\sum_{i=1}^{n}\left(\ x_i-\bar{x}\right)^2}{n-1}}$$
:::


### Basic Code

For a single quantitative variable, `x`, here is the general structure for calculating a standard deviation in R using the `sd()` function from the `mosaic` package.

```{r}
#| label: one-var-structure-sd
#| eval: false
sd(~x, data = mydata)
```

Run the code below to see an example using the **quantitative** variable `bill_length_mm` from the `penguins` data. Then replace `bill_length_mm` with another quantitative variable from the `penguins` data (e.g. `bill_depth_mm`)

```{webr}
#| label: sd-one
sd(~bill_length_mm, data = penguins)
```

::: {.callout-warning collapse="true"}
## Handling Missing Values
Notice the returned value of `NA`. The function needs to have another argument added that tells R to ignore missing values (`NA`) in order to calculate the median, `na.rm = TRUE`. Add the argument to the code above

```{r}
#| label: one-var-structure-na-sd
#| eval: false
sd(~x, data = mydata, na.rm = TRUE)
```

:::


### Multiple Standard Deviations Across Groups

When we want to calculate the standard deviation of a **quantitative** variable (`y`) measured across the values/groups of a **categorical** variable (`x`) it is a simple modification to the single standard deviation code.

```{r}
#| label: two-var-structure-sd
#| eval: false
sd(y ~ x, data = mydata)
```

Run the code below to see an example using the **quantitative** variable `bill_length_mm` and `species` from the `penguins` data. Then replace `bill_length_mm` with another quantitative variable from the `penguins` data (e.g. `bill_depth_mm`) and/or another categorical variable (e.g., `sex`). 

Remember to add `na.rm = TRUE` if you get a *warning*. 

```{webr}
#| label: sd-two
sd(bill_length_mm ~ species, data = penguins)
```


## Quartiles/Percentiles





## Interquartile Range (IQR)




## Range
